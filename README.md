# 深層学習による画質の改善
私は卒業研究で深層学習を用いた画質の改善というテーマで研究を行っておりました。「より良い画質の改善」という課題に対して、深層学習の学習段階を2段階に分割して行うというアプローチで取り組んでいました。
このレポジトリでは、画質を向上させたい画像ときれいな画像のデータセットを用意してもらえれば、学習とテストが行うことができます。

# プログラムの使い方
1.学習用のデータセットを用意します
できるだけ高画質かつ自身が向上させたい画像と関連のある画像をたくさん用意します。
例：街の風景の画像の画質を向上させたい→建物が多く映った高画質な画像をたくさん用意する
このプログラムはこのデータセットの画像たちの”ような”画質になるように目指して学習を行います。用意したデータセットが高画質かつ関連性が高いほど良い結果が得られやすくなります。

2.データセットを使った学習
用意したデータセットを使って学習を始めます。
用意したデータセットをSTEP1フォルダ内に保存して、以下のコマンドを実行して1段階目の学習を開始します。
```bash
python main.py --images_dir "学習フォルダ名"
               --outputs_dir outputs
               --num_epochs 31
```
学習が終わったら、次にSTEP1フォルダ内に「SR1」という名前でフォルダを作成し、以下のコマンドを実行します。
```bash
python SR1.py --weights_path outputs/RCAN_epoch_30.pth
              --images_dir "学習フォルダ名"
              --SR1_images_dir SR1
```
これが終わったら、データセットのフォルダと、STEP1内の「SR1」フォルダをSTEP2フォルダ内に移動させ、以下のコマンドを実行して2段階目の学習を開始します。
```bash
python main.py --HR_images_dir "学習フォルダ名"
               --LR_images_dir SR1
               --outputs_dir outputs
               --num_epochs 31
```
この学習が終わったら、いよいよ画質の向上が可能になります。画質を向上させたい画像をフォルダ内にまとめてSTEP1に保存し、それとは別に「SR1_test」という名前で空のフォルダを作成し以下のコマンドを実行します。
```bash
python SR1.py --weights_path outputs/RCAN_epoch_30.pth
              --images_dir "画質を向上させたい画像のフォルダ名"
              --SR1_images_dir SR1_test
```
最後にSTEP1内の「SR1_test」フォルダをSTEP2フォルダ内に移動させ、「SR2_test」という名前で空のフォルダを作成し以下のコマンドを実行します。
```bash
python SR1.py --weights_path outputs/RCAN_epoch_30.pth
              --images_dir SR1_test
              --SR2_images_dir SR2_test
```
これで学習とテストが終了しました。
STEP2フォルダ内のSR2_testフォルダ内に画質が改善された画像が保存されているはずです。
